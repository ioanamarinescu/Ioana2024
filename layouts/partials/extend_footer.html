<script>
// Search overlay fix for Hugo Blox
document.addEventListener('DOMContentLoaded', function() {
  // Inject CSS to fix search overlay
  const style = document.createElement('style');
  style.innerHTML = `
    /* When search is visible, prevent body scroll */
    body:has(#search:not(.hidden)) {
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
    }
    
    /* Make search container cover entire viewport */
    #search:not(.hidden) {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      background-color: white !important;
      z-index: 99999 !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
    }
    
    /* Dark mode support */
    .dark #search:not(.hidden) {
      background-color: rgb(21, 32, 40) !important;
    }
    
    /* Ensure pagefind UI container has proper background */
    .pagefind-ui {
      background-color: inherit !important;
      min-height: 100vh !important;
    }
    
    .pagefind-ui__drawer {
      background-color: inherit !important;
    }
    
    .pagefind-ui__results {
      background-color: inherit !important;
      padding-bottom: 100px !important;
    }
  `;
  document.head.appendChild(style);
  
  // Also handle body scroll dynamically
  const searchEl = document.getElementById('search');
  if (searchEl) {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.attributeName === 'class') {
          if (!searchEl.classList.contains('hidden')) {
            document.body.style.overflow = 'hidden';
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
          } else {
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
          }
        }
      });
    });
    
    observer.observe(searchEl, { attributes: true });
  }
});
</script>
